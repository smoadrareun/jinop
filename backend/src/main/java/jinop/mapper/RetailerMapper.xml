<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jinop.mapper.RetailerMapper">
    <!--因为在sqlMapConfig.xml中配置了别名，所以直接写commodity就可以-->
    <select id="checkRetailer" parameterType="map" resultType="int">
        SELECT count(1) FROM retinfo
        <where>
            <if test="id!=null and id!=''">
                id=#{id}
            </if>
            <if test="money!=null and money!=''">
                AND money=#{money}
            </if>
            <if test="name!=null and name!=''">
                AND name=#{name}
            </if>
            <if test="num!=null and num!=''">
                AND num=#{num}
            </if>
            <if test="addinfo!=null and addinfo!=''">
                AND addinfo=#{addinfo}
            </if>
            <if test="disc!=null and disc!=''">
                AND disc=#{disc}
            </if>
            <if test="dist!=null and dist!=''">
                AND dist=#{dist}
            </if>
            <if test="longi!=null and longi!=''">
                AND longi=#{longi}
            </if>
            <if test="lati!=null and lati!=''">
                AND lati=#{lati}
            </if>
        </where>
    </select>

    <insert id="addRetailer" parameterType="map" >
        INSERT INTO  retinfo(
            id,money,name,num,addinfo,disc,dist,longi,lati
        )VALUES (
        #{id},
        <choose>
            <when test="money != null and money !=''">
                #{money},
            </when>
            <otherwise>
                0.00,
            </otherwise>
        </choose>
        #{name},
        #{num},
        #{addinfo},
        <choose>
            <when test="disc != null and disc !=''">
                #{disc},
            </when>
            <otherwise>
                10.0,
            </otherwise>
        </choose>
        #{dist},
        #{longi},
        #{lati}
        )
    </insert>

    <delete id="deleteRetailer" parameterType="int">
        DELETE FROM retinfo where id=#{id}
    </delete>

    <update id="editCommodity" parameterType="map">
        UPDATE retinfo
        <set>
            <if test="name !=null and name !=''">
                name=#{name},
            </if>
            <if test="money !=null and money !=''">
                price=#{price},
            </if>
            <if test="name !=null and name !=''">
                name=#{name},
            </if>
            <if test="num !=null and num !=''">
                num=#{num},
            </if>
            <if test="addinfo !=null and addinfo !=''">
                addinfo=#{addinfo},
            </if>
            <if test="disc !=null and disc !=''">
                disc=#{disc},
            </if>
            <if test="dist !=null and dist !=''">
                dist=#{dist},
            </if>
            <if test="longi !=null and longi !=''">
                longi=#{longi}
            </if>
            <if test="lati !=null and lati !=''">
                lati=#{lati}
            </if>
        </set>
        WHERE id=#{id}
    </update>

    <select id="showRetailer" parameterType="map" resultType="retailer">
        SELECT * FROM retinfo
        <where>
            <if test="id!=null and id!=''">
                id LIKE CONCAT('%',#{id},'%')
            </if>
            <if test="money!=null and money!=''">
                AND money LIKE CONCAT('%',#{money},'%')
            </if>
            <if test="name!=null and name!=''">
                AND name LIKE CONCAT('%',#{name},'%')
            </if>
            <if test="num!=null and num!=''">
                AND num LIKE CONCAT('%',#{num},'%')
            </if>
            <if test="addinfo!=null and addinfo!=''">
                AND addinfo LIKE CONCAT('%',#{addinfo},'%')
            </if>
            <if test="disc!=null and disc!=''">
                AND disc LIKE CONCAT('%',#{disc},'%')
            </if>
            <if test="dist!=null and dist!=''">
                AND dist LIKE CONCAT('%',#{dist},'%')
            </if>
            <if test="longi!=null and longi!=''">
                AND longi LIKE CONCAT('%',#{longi},'%')
            </if>
            <if test="lati!=null and lati!=''">
                AND lati LIKE CONCAT('%',#{lati},'%')
            </if>
        </where>
    </select>

    <select id="findRetailer" parameterType="map" resultType="retailer">
        SELECT * FROM cominfo
        <where>
            <if test="id!=null and id!=''">
                id=#{id}
            </if>
            <if test="money!=null and money!=''">
                AND money=#{money},
            </if>
            <if test="name!=null and name!=''">
                AND name=#{name}
            </if>
            <if test="num!=null and num!=''">
                AND num=#{num}
            </if>
            <if test="addinfo!=null and addinfo!=''">
                AND addinfo=#{addinfo}
            </if>
            <if test="disc!=null and disc!=''">
                AND disc=#{disc}
            </if>
            <if test="dist!=null and dist!=''">
                AND dist=#{dist}
            </if>
            <if test="longi!=null and longi!=''">
                AND longi=#{longi}
            </if>
            <if test="lati!=null and lati!=''">
                AND lati=#{lati}
            </if>
        </where>
    </select>

</mapper>
